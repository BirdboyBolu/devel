version: "3.4"

x-common: &common
  context: ./../../

services:

  app:
    image: bitdust_perf/app
    build:
      <<: *common
      dockerfile: regress/Dockerfiles/app/Dockerfile
    environment:
      dht_seeds: genesis
      delayed: 0

  genesis:
    image: bitdust_perf/app
    build:
      context: .
    environment:
      dht_seeds: genesis
      delayed: 0

  seed1:
    image: bitdust_perf/app
    build:
      context: .
    environment:
      dht_seeds: genesis:14441
      delayed: 1

  seed2:
    image: bitdust_perf/app
    build:
      context: .
    environment:
      dht_seeds: genesis:14441
      delayed: 3

  seed3:
    image: bitdust_perf/app
    build:
      context: .
    environment:
      dht_seeds: genesis:14441
      delayed: 5

  seed4:
    image: bitdust_perf/app
    build:
      context: .
    environment:
      dht_seeds: genesis:14441
      delayed: 7

  node1:
    image: bitdust_perf/app
    build:
      context: .
    environment:
      dht_seeds: seed1:14441,seed3:14441
      delayed: 11

  node2:
    image: bitdust_perf/app
    build:
      context: .
    environment:
      dht_seeds: seed2:14441,seed4:14441
      delayed: 13

  node3:
    image: bitdust_perf/app
    build:
      context: .
    environment:
      dht_seeds: seed3:14441
      delayed: 15

  node4:
    image: bitdust_perf/app
    build:
      context: .
    environment:
      dht_seeds: seed4:14441
      delayed: 17

  producer:
    image: bitdust_perf/producer
    build:
      context: .
      dockerfile: Dockerfile_producer

  consumer:
    image: bitdust_perf/consumer
    build:
      context: .
      dockerfile: Dockerfile_consumer
